name: import_google

on: 
  workflow_dispatch:
  push:
    branches: [ "gdocs"]

jobs:
  publish:
    runs-on: ubuntu-latest
    
    # Add "id-token" with the intended permissions.
    permissions:
      contents: 'read'
      id-token: 'write'

    steps:
    - uses: 'actions/checkout@v3'
      with:
        ref: 'gdoc'
        token : '${{ secrets.GH_PAT}}'

    - id: 'auth'
      name: 'Authenticate to Google Cloud'
      uses: 'google-github-actions/auth@v1'
      with:
        token_format: 'access_token'
        credentials_json: '${{ secrets.GCP_KEY }}'
        access_token_scopes: 'https://www.googleapis.com/auth/drive'
    
    - run: |-
        echo '${{ steps.auth.outputs.access_token}}'
        
    - uses: r7kamura/google-docs-to-github@v3
      with:
        google_drive_folder_id: 1RsTyNtKpbJfNEy75WuayMEsCneKl8f6f
        github_branch: gdoc
        github_token : '${{ secrets.GH_PAT}}'
